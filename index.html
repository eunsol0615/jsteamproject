<!DOCTYPE html>
<html class="light" lang="ko">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>HGU Works</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries,typography"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet"/>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        html {
            scroll-behavior: smooth;
        }
        /* ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 20px;
        }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #475569;
        }

        /* ëª¨ë‹¬ ìŠ¬ë¼ì´ë” íŠ¸ëœì§€ì…˜ */
        .slide-image {
            transition: opacity 0.5s ease-in-out;
        }
        /* ë¡œê·¸ì¸ ëª¨ë‹¬ íŠ¸ëœì§€ì…˜ */
        .login-modal-panel {
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
    </style>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101922",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                },
            },
        }
    </script>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-[#0d141b] dark:text-slate-50">
    <div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden">
        <div class="layout-container flex h-full grow flex-col">
            
            <header class="sticky top-0 z-40 flex items-center justify-between whitespace-nowrap border-b border-solid border-slate-200 dark:border-slate-800 px-4 py-4 bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-sm">
                <div class="flex items-center gap-8">
                    <div class="flex items-center gap-3 text-primary">
                        <div class="size-6">
                            <svg fill="none" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                                <path d="M4 4H17.3334V17.3334H30.6666V30.6666H44V44H4V4Z" fill="currentColor"></path>
                            </svg>
                        </div>
                        <h2 class="text-lg font-bold leading-tight tracking-[-0.015em] text-[#0d141b] dark:text-slate-50">HGU Works</h2>
                    </div>
                    <nav class="hidden md:flex items-center gap-6">
                        <a class="text-sm font-medium leading-normal text-slate-700 dark:text-slate-300 hover:text-primary dark:hover:text-primary transition-colors" href="ê¸°ê³„.html">ê¸°ê³„ì œì–´Â·ì „ì‚°ì „ìê³µí•™ë¶€</a>
                        <a class="text-sm font-medium leading-normal text-slate-700 dark:text-slate-300 hover:text-primary dark:hover:text-primary transition-colors" href="ë””ìì¸.html">ì½˜í…ì¸ ìœµí•©ë””ìì¸í•™ë¶€</a>
                    </nav>
                </div>
                 <div class="flex flex-1 justify-end gap-4">
                    
                    <button onclick="openLoginModal()" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-slate-50 text-sm font-bold leading-normal tracking-[0.015em] hover:bg-primary/90 transition-colors">
                        <span class="truncate">ë¡œê·¸ì¸ / íšŒì›ê°€ì…</span>
                    </button>
                </div>
            </header>

            <main class="flex-grow">
                <div class="@container py-10 px-4 md:px-10 lg:px-20">
                    <div class="@[480px]:p-4">
                        <div class="flex min-h-[480px] flex-col gap-6 bg-cover bg-center bg-no-repeat @[480px]:gap-8 rounded-xl items-center justify-center p-6 text-center" style='background-image: linear-gradient(rgba(0, 0, 0, 0.2) 0%, rgba(0, 0, 0, 0.5) 100%), url("https://images.unsplash.com/photo-1451187580459-43490279c0fa?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80");'>
                            <div class="flex flex-col gap-2 text-center text-slate-50 drop-shadow-lg">
                                <h1 class="text-4xl font-black leading-tight tracking-[-0.033em] @[480px]:text-5xl @[480px]:font-black @[480px]:leading-tight @[480px]:tracking-[-0.033em]">ë¯¸ë˜ì˜ í˜ì‹ ê°€ë“¤ì„ ìœ„í•œ ê³µê°„</h1>
                                <h2 class="text-slate-200 text-base font-normal leading-normal @[480px]:text-lg @[480px]:font-normal @[480px]:leading-normal">ìµœê³ ì˜ ê³µí•™ ë° ë””ìì¸ í•™ìƒë“¤ì˜ ë†€ë¼ìš´ í”„ë¡œì íŠ¸ë¥¼ ë°œê²¬í•˜ê³  ì†Œê°œí•˜ì„¸ìš”.</h2>
                            </div>
                            
                        </div>
                    </div>
                </div>

                <section id="mech" class="py-16 px-4 md:px-10 lg:px-20 scroll-mt-20 bg-slate-50 dark:bg-slate-900/30">
                     <div class="flex flex-col gap-6">
                        <div class="flex flex-col md:flex-row gap-4 justify-between items-start md:items-center pb-6 border-b border-slate-200 dark:border-slate-800">
                            <div class="flex flex-col gap-2">
                                <h1 class="text-3xl font-black leading-tight tracking-[-0.033em] text-slate-900 dark:text-slate-50">ê¸°ê³„ì œì–´Â·ì „ì‚°ì „ìê³µí•™ë¶€</h1>
                                <p class="text-base font-normal leading-normal text-slate-500 dark:text-slate-400">ì„¤ê³„, í•´ì„, ê·¸ë¦¬ê³  ì œì–´ì˜ ì •ì </p>
                            </div>
                            
                        </div>
                        
                        
                     </div>
                </section>

                <hr class="border-slate-200 dark:border-slate-800 my-8"/>

                <section id="design" class="py-16 px-4 md:px-10 lg:px-20 scroll-mt-20">
                    <div class="flex flex-col gap-6">
                        <div class="flex flex-col md:flex-row gap-4 justify-between items-start md:items-center pb-6 border-b border-slate-200 dark:border-slate-800">
                             <div class="flex flex-col gap-2">
                                <h3 class="text-3xl font-black text-slate-900 dark:text-slate-50">ì½˜í…ì¸ ìœµí•©ë””ìì¸í•™ë¶€</h3>
                                <p class="text-base text-slate-500 dark:text-slate-400">ì‹œê°, ê·¸ë¦¬ê³  ì‚¬ìš©ì ê²½í—˜ì˜ í˜ì‹ </p>
                            </div>
                            
                        </div>
                        
                        
                    </div>
                </section>

            </main>

            <footer class="mt-20 border-t border-slate-200 dark:border-slate-800 pt-10 pb-8 bg-background-light dark:bg-background-dark px-4 md:px-10 lg:px-20">
                <div class="flex flex-col md:flex-row justify-between items-center gap-8">
                    <div class="flex items-center gap-3 text-primary">
                        <div class="size-6">
                            <svg fill="none" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                                <path d="M4 4H17.3334V17.3334H30.6666V30.6666H44V44H4V4Z" fill="currentColor"></path>
                            </svg>
                        </div>
                        <h2 class="text-lg font-bold leading-tight tracking-[-0.015em] text-[#0d141b] dark:text-slate-50">HGU Works</h2>
                    </div>
                    <nav class="flex flex-wrap justify-center gap-x-6 gap-y-2 text-sm">
                        <a class="text-slate-600 dark:text-slate-300 hover:text-primary dark:hover:text-primary transition-colors" href="#">ì„œë¹„ìŠ¤ ì†Œê°œ</a>
                        <a class="text-slate-600 dark:text-slate-300 hover:text-primary dark:hover:text-primary transition-colors" href="#">ë¬¸ì˜í•˜ê¸°</a>
                        <a class="text-slate-600 dark:text-slate-300 hover:text-primary dark:hover:text-primary transition-colors" href="#">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
                        <a class="text-slate-600 dark:text-slate-300 hover:text-primary dark:hover:text-primary transition-colors" href="#">ì´ìš©ì•½ê´€</a>
                    </nav>
                </div>
                <div class="mt-8 text-center text-xs text-slate-400">
                    &copy; 2025 HGU Works. All rights reserved.
                </div>
            </footer>
        </div>
    </div>

    
    <div id="login-modal" class="fixed inset-0 z-[200] hidden" aria-modal="true" role="dialog">
        <div id="login-backdrop" class="absolute inset-0 bg-black/70 backdrop-blur-sm transition-opacity opacity-0" onclick="closeLoginModal()"></div>
        
        <div class="relative flex min-h-full items-center justify-center p-4">
            <div id="login-panel" class="login-modal-panel relative w-full max-w-md overflow-hidden rounded-2xl bg-white dark:bg-slate-900 shadow-2xl ring-1 ring-slate-900/5 transform translate-y-4 opacity-0">
                <button onclick="closeLoginModal()" class="absolute right-4 top-4 z-10 rounded-full bg-black/20 p-2 text-white/80 hover:bg-black/40 dark:bg-white/10 dark:text-slate-200 dark:hover:bg-white/20 transition-colors">
                    <span class="material-symbols-outlined text-xl">close</span>
                </button>
                
                <div class="p-8">
                    <h2 class="text-3xl font-bold text-center text-slate-900 dark:text-white mb-6">ë¡œê·¸ì¸</h2>
                    <form id="login-form" class="flex flex-col gap-4">
                        <div>
                            <label for="email" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">ì´ë©”ì¼</label>
                            <input type="email" id="email" class="form-input w-full rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 px-4 py-2 text-base text-slate-900 dark:text-white focus:ring-primary focus:border-primary" placeholder="name@example.com" required>
                        </div>
                        <div>
                            <label for="password" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">ë¹„ë°€ë²ˆí˜¸</label>
                            <input type="password" id="password" class="form-input w-full rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 px-4 py-2 text-base text-slate-900 dark:text-white focus:ring-primary focus:border-primary" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
                        </div>
                        ì´ë©”ì¼ : 11@11
                        ë¹„ë°€ë²ˆí˜¸ 1111
                        <button type="submit" class="flex min-w-[84px] max-w-full cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 mt-2 bg-primary text-slate-50 text-base font-bold leading-normal tracking-[0.015em] hover:bg-primary/90 transition-colors">
                            <span class="truncate">ë¡œê·¸ì¸</span>
                        </button>
                    </form>
                    
                </div>
            </div>
        </div>
    </div>
    <div id="upload-modal" class="relative z-[300] hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>
    <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
        <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
            <div class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg">
                <div class="bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4">
                    <h3 class="text-lg font-bold leading-6 text-gray-900 mb-4">ìƒˆ ê²Œì‹œë¬¼ ì‘ì„±</h3>
                    <form id="upload-form" class="flex flex-col gap-4">
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ì¹´í…Œê³ ë¦¬</label>
                            <select id="post-category" class="w-full rounded-md border-0 py-2 px-3 ring-1 ring-inset ring-gray-300">
                                <option value="machine">ê¸°ê³„ì œì–´ê³µí•™ë¶€</option>
                                <option value="design">ì½˜í…ì¸ ìœµí•©ë””ìì¸í•™ë¶€</option>
                            </select>
                        </div>

                        <input type="text" id="post-title" placeholder="ì œëª©" class="w-full rounded-md border-0 py-2 px-3 ring-1 ring-inset ring-gray-300" required>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ì´ë¯¸ì§€</label>
                            <input type="file" id="post-image" accept="image/*" class="block w-full text-sm text-slate-500">
                        </div>

                        <textarea id="post-content" rows="3" placeholder="ë‚´ìš©" class="w-full rounded-md border-0 py-2 px-3 ring-1 ring-inset ring-gray-300" required></textarea>

                        <div class="flex justify-end gap-2 mt-4">
                            <button type="button" onclick="document.getElementById('upload-modal').classList.add('hidden')" class="bg-gray-200 px-4 py-2 rounded-md">ì·¨ì†Œ</button>
                            <button type="submit" class="bg-indigo-600 text-white px-4 py-2 rounded-md">ì—…ë¡œë“œ</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


    
    <script>
        // ==========================================
        // 1. ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ (ì´ë¯¸ì§€ ë³€í™˜ ë“±)
        // ==========================================
        
        // íŒŒì¼ì„ Base64 ë¬¸ìì—´(í…ìŠ¤íŠ¸)ë¡œ ë³€í™˜í•´ì£¼ëŠ” í•¨ìˆ˜
        function convertToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }

        // ==========================================
        // 2. ì „ì—­ ë³€ìˆ˜ ë° ì´ˆê¸°í™”
        // ==========================================
        let currentUser = null;
        let allPosts = []; 

        // DOMì´ ë¡œë“œë˜ë©´ ì‹¤í–‰
        window.addEventListener('DOMContentLoaded', () => {
            const savedUser = localStorage.getItem('user');
            if (savedUser) updateLoginState(savedUser);
            loadPosts(); // ê²Œì‹œë¬¼ ë¶ˆëŸ¬ì˜¤ê¸°
        });

        // ==========================================
        // 3. ë¡œê·¸ì¸ / ë¡œê·¸ì•„ì›ƒ ê´€ë¦¬
        // ==========================================
        
        // ë¡œê·¸ì¸ ìƒíƒœ UI ì—…ë°ì´íŠ¸
       function updateLoginState(username) {
    currentUser = username;
    const headerLoginBtn = document.querySelector('header button'); 
    
    if(headerLoginBtn) {
        const textSpan = headerLoginBtn.querySelector('span:not(.material-symbols-outlined)') || headerLoginBtn;
        textSpan.innerText = 'My Page'; 
        
        // [ìˆ˜ì •] í´ë¦­í•˜ë©´ ì•Œë¦¼ì°½ ëŒ€ì‹  mypage.htmlë¡œ ì´ë™
        headerLoginBtn.onclick = function() {
            window.location.href = 'mypage.html';
        };
    }
    
    const uploadBtn = document.getElementById('show-upload-btn');
    if(uploadBtn) uploadBtn.classList.remove('hidden');
    if (typeof closeLoginModal === 'function') closeLoginModal();
}
        // [ì¤‘ìš”] ë¡œê·¸ì¸ í¼ ì œì¶œ (ì„œë²„ í†µì‹  ì¶”ê°€ë¨)
        const loginForm = document.getElementById('login-form');
        if (loginForm) {
            loginForm.addEventListener('submit', async function(e) {
                e.preventDefault(); 

                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;

                try {
                    // [ìˆ˜ì •] localhost ì œê±° -> /api/login ì‚¬ìš©
                    const response = await fetch('/api/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, password })
                    });

                    const data = await response.json();

                    if (response.ok) {
                        alert('ë¡œê·¸ì¸ ì„±ê³µ!');
                        localStorage.setItem('user', data.user); // ìœ ì € ì •ë³´ ì €ì¥
                        updateLoginState(data.user);
                        closeLoginModal();
                    } else {
                        alert(data.message || 'ë¡œê·¸ì¸ ì‹¤íŒ¨');
                    }
                } catch (error) {
                    console.error('Login Error:', error);
                    alert('ì„œë²„ ì—°ê²° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            });
        }

        // ==========================================
        // 4. ê²Œì‹œë¬¼ ë¶ˆëŸ¬ì˜¤ê¸° (Read)
        // ==========================================
        async function loadPosts() {
            const container = document.getElementById('posts-container');
            // ë§Œì•½ posts-containerê°€ ì—†ë‹¤ë©´(ì„¹ì…˜ ë“±) querySelectorë¡œ ëŒ€ì²´í•´ì•¼ í•  ìˆ˜ë„ ìˆìŒ
            // í˜„ì¬ HTML êµ¬ì¡°ìƒ id="posts-container"ë¥¼ ê°€ì§„ divê°€ ì•ˆ ë³´ì…ë‹ˆë‹¤.
            // **ì£¼ì˜**: HTML <body> ì–´ë”˜ê°€ì— <div id="posts-container" ...>ê°€ ìˆì–´ì•¼ ê²Œì‹œë¬¼ì´ ë³´ì…ë‹ˆë‹¤.
            // ê¸°ê³„/ë””ìì¸ ì„¹ì…˜ ì•ˆì— ê°ê° ë„£ìœ¼ë ¤ë©´ ì½”ë“œê°€ ë” ë³µì¡í•´ì§€ë¯€ë¡œ, 
            // ì¼ë‹¨ 'ì½˜í…ì¸ ìœµí•©ë””ìì¸í•™ë¶€' ì„¹ì…˜ ì•„ë˜ë‚˜ ì ì ˆí•œ ê³³ì— idë¥¼ ì¶”ê°€í–ˆë‹¤ê³  ê°€ì •í•˜ê³  ì‘ì„±í•©ë‹ˆë‹¤.
            
            // ì„ì‹œ: main íƒœê·¸ ì•ˆì— ì»¨í…Œì´ë„ˆê°€ ì—†ë‹¤ë©´ ë™ì‘í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë‹ˆ í™•ì¸ í•„ìš”
            // ì—¬ê¸°ì„œëŠ” ì„œë²„ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë¡œì§ì— ì§‘ì¤‘í•©ë‹ˆë‹¤.
            
            // ê¸°ì¡´ ì½”ë“œì˜ ì»¨í…Œì´ë„ˆ ì°¾ê¸° ë¡œì§ì´ ì—†ì–´ì„œ, ê¸°ê³„/ë””ìì¸ ì„¹ì…˜ì— ì§ì ‘ ë„£ëŠ” ë¡œì§ìœ¼ë¡œ ë³´ì™„í•©ë‹ˆë‹¤.
            const mechSection = document.getElementById('mech');
            const designSection = document.getElementById('design');
            
            // ê¸°ì¡´ ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ê³  ë‹¤ì‹œ ì±„ì›Œë„£ê¸° ìœ„í•´ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ìŠµë‹ˆë‹¤.
            // (HTMLì— id="posts-container"ê°€ ì—†ë‹¤ë©´ ì•„ë˜ ë¡œì§ì€ ë¬´ì‹œë  ìˆ˜ ìˆìŒ)
            // ë”°ë¼ì„œ ì˜ˆì‹œë¡œ ê¸°ê³„/ë””ìì¸ ì„¹ì…˜ ë‚´ë¶€ì˜ divë¥¼ íƒ€ê²ŸíŒ…í•©ë‹ˆë‹¤.
            
            try {
                // [ìˆ˜ì •] localhost ì œê±° -> /api/posts ì‚¬ìš©
                const response = await fetch('/api/posts');
                if (!response.ok) throw new Error('ê²Œì‹œë¬¼ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨');
                
                const posts = await response.json();
                allPosts = posts; 

                // í™”ë©´ì— ê·¸ë¦¬ê¸° (ê°„ë‹¨íˆ ê¸°ì¡´ ì„¹ì…˜ì— ì¶”ê°€í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„)
                // ì‹¤ì œë¡œëŠ” id="mech-container" ê°™ì€ ê²ƒì„ HTMLì— ë§Œë“¤ì–´ë‘ëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤.
                // ì—¬ê¸°ì„œëŠ” ê¸°ì¡´ ì„¹ì…˜ ë‚´ë¶€ì— divë¥¼ ë™ì ìœ¼ë¡œ ì°¾ì•„ì„œ ë„£ìŠµë‹ˆë‹¤.
                
                // 1. ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ ì²­ì†Œ (í•„ìš”ì‹œ êµ¬í˜„)
                
                // 2. ì„¹ì…˜ë³„ë¡œ ê²Œì‹œë¬¼ ë¶„ë¥˜í•´ì„œ ë„£ê¸°
                const mechContainer = mechSection ? mechSection.querySelector('.flex.flex-col.gap-6') : null;
                const designContainer = designSection ? designSection.querySelector('.flex.flex-col.gap-6') : null;

                // ê¸°ì¡´ ê²Œì‹œë¬¼(ì„œë²„ì—ì„œ ë¶ˆëŸ¬ì˜¨ ê²ƒë“¤) ì‚­ì œ í›„ ë‹¤ì‹œ ë Œë”ë§
                document.querySelectorAll('.server-post-item').forEach(el => el.remove());

                posts.forEach(post => {
                    const date = new Date(post.date).toLocaleDateString();
                    
                    const imageHTML = post.image 
                        ? `<img src="${post.image}" class="h-full w-full object-cover">` 
                        : `<div class="h-full w-full bg-slate-200 flex items-center justify-center text-2xl">ğŸ“„</div>`;

                    const cardHTML = `
                        <div onclick="openDetailModal(${post.id})" class="server-post-item group relative overflow-hidden rounded-xl bg-white dark:bg-slate-800 shadow-md transition-all hover:-translate-y-1 hover:shadow-xl cursor-pointer border border-slate-200 dark:border-slate-700">
                            <div class="aspect-video w-full overflow-hidden bg-gray-200">${imageHTML}</div>
                            <div class="p-4">
                                <h3 class="mb-1 text-lg font-bold text-slate-900 dark:text-slate-50 line-clamp-1">${post.title}</h3>
                                <p class="text-sm text-slate-600 dark:text-slate-400 line-clamp-2">${post.content}</p>
                                <div class="mt-4 flex items-center justify-between border-t border-slate-100 dark:border-slate-700 pt-3">
                                    <span class="text-xs text-slate-500 dark:text-slate-500">${post.author.split('@')[0]}</span>
                                    <span class="text-xs text-slate-400">${date}</span>
                                </div>
                            </div>
                        </div>`;

                    // ì¹´í…Œê³ ë¦¬ì— ë§ëŠ” ì„¹ì…˜ì— ì¶”ê°€
                    if (post.category === 'machine' && mechContainer) {
                        // ì„¹ì…˜ ë‚´ë¶€ì— ê·¸ë¦¬ë“œ ì»¨í…Œì´ë„ˆê°€ ì—†ìœ¼ë©´ í•˜ë‚˜ ë§Œë“¦
                        let grid = mechContainer.querySelector('.grid-container');
                        if(!grid) {
                            grid = document.createElement('div');
                            grid.className = 'grid-container grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6';
                            mechContainer.appendChild(grid);
                        }
                        grid.insertAdjacentHTML('beforeend', cardHTML);
                    } else if (post.category === 'design' && designContainer) {
                        let grid = designContainer.querySelector('.grid-container');
                        if(!grid) {
                            grid = document.createElement('div');
                            grid.className = 'grid-container grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6';
                            designContainer.appendChild(grid);
                        }
                        grid.insertAdjacentHTML('beforeend', cardHTML);
                    }
                });
            } catch (error) { 
                console.error("ê²Œì‹œë¬¼ ë¡œë“œ ì—ëŸ¬:", error); 
            }
        }

        // ==========================================
        // 5. ê²Œì‹œë¬¼ ì—…ë¡œë“œ (Create)
        // ==========================================
        const uploadForm = document.getElementById('upload-form');
        if (uploadForm) {
            uploadForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                if (!currentUser) currentUser = localStorage.getItem('user');
                if (!currentUser) { alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤!"); return; }

                const title = document.getElementById('post-title').value;
                const content = document.getElementById('post-content').value;
                const category = document.getElementById('post-category').value;
                const fileInput = document.getElementById('post-image');

                // ì´ë¯¸ì§€ ë³€í™˜ ì²˜ë¦¬
                let imageBase64 = null;
                if (fileInput.files.length > 0) {
                    try {
                        imageBase64 = await convertToBase64(fileInput.files[0]);
                    } catch (err) {
                        alert("ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                        return;
                    }
                }

                try {
                    // [ìˆ˜ì •] localhost ì œê±° -> /api/posts ì‚¬ìš©
                    const response = await fetch('/api/posts', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            title, 
                            content, 
                            author: currentUser,
                            category, // ì¹´í…Œê³ ë¦¬ ì¶”ê°€
                            image: imageBase64 // ì´ë¯¸ì§€ ë°ì´í„° ì¶”ê°€
                        })
                    });
                    
                    if (response.ok) {
                        alert('ê²Œì‹œë¬¼ì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
                        document.getElementById('upload-modal').classList.add('hidden');
                        uploadForm.reset(); // í¼ ì´ˆê¸°í™”
                        loadPosts(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    } else {
                        alert('ì—…ë¡œë“œ ì‹¤íŒ¨: ì„œë²„ ì˜¤ë¥˜');
                    }
                } catch (error) { 
                    console.error(error); 
                    alert('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë°œìƒ'); 
                }
            });
        }

        // ==========================================
        // 6. ëª¨ë‹¬ ê´€ë ¨ UI ë¡œì§ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
        // ==========================================
        
        // ìƒì„¸ ëª¨ë‹¬ (DB ë°ì´í„°ìš©)
        // HTML ì–´ë”˜ê°€ì— id="detail-modal" êµ¬ì¡°ê°€ ìˆì–´ì•¼ ëœ¹ë‹ˆë‹¤. 
        // í˜„ì¬ HTMLì—ëŠ” id="detail-modal"ì´ ì—†ì–´ì„œ ì¶”ê°€í•´ ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤.
        // ë˜ëŠ” ê¸°ì¡´ project-modalì„ ì¬í™œìš©í•´ì•¼ í•©ë‹ˆë‹¤.
        // ì—¬ê¸°ì„œëŠ” ê¸°ì¡´ 'project-modal'ì„ ì¬í™œìš©í•˜ëŠ” ì½”ë“œë¡œ ì‘ì„±í•©ë‹ˆë‹¤.
        
        const modal = document.getElementById('project-modal') || createDetailModalIfMissing(); // ì—†ìœ¼ë©´ ìƒì„± ì‹œë„
        const modalBackdrop = document.getElementById('modal-backdrop');
        const modalPanel = document.getElementById('modal-panel');

        function openDetailModal(id) {
            const post = allPosts.find(p => p.id === id);
            if (!post) return;

            // ìƒì„¸ ëª¨ë‹¬ ë‚´ìš© ì±„ìš°ê¸° (HTML êµ¬ì¡°ì— ë”°ë¼ idê°€ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ)
            // ì—¬ê¸°ì„œëŠ” alertë¡œ ë‚´ìš©ì„ ë³´ì—¬ì£¼ê±°ë‚˜, ê¸°ì¡´ HTML êµ¬ì¡°ì— ë§ì¶° ê°’ì„ ë„£ìŠµë‹ˆë‹¤.
            // * ì•„ë˜ idë“¤ì€ HTMLì— ì‹¤ì œë¡œ ì¡´ì¬í•´ì•¼ ì—ëŸ¬ê°€ ì•ˆ ë‚©ë‹ˆë‹¤.
            const titleEl = document.getElementById('modal-title');
            if(titleEl) titleEl.innerText = post.title;
            
            const descEl = document.getElementById('modal-description');
            if(descEl) descEl.innerText = post.content;

            // ì´ë¯¸ì§€ê°€ ìˆë‹¤ë©´ ë³´ì—¬ì£¼ê¸°
            const sliderContainer = document.getElementById('modal-slider-container');
            if(sliderContainer) {
                sliderContainer.innerHTML = post.image 
                    ? `<img src="${post.image}" class="w-full h-full object-contain">` 
                    : `<div class="flex items-center justify-center h-full text-gray-400">ì´ë¯¸ì§€ ì—†ìŒ</div>`;
            }

            // ëª¨ë‹¬ ë„ìš°ê¸° (ê¸°ì¡´ í•¨ìˆ˜ ì¬í™œìš©)
            if(modal) modal.classList.remove('hidden');
        }

        // (í—¬í¼) ìƒì„¸ ëª¨ë‹¬ì´ HTMLì— ì—†ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•´ ì°¾ëŠ” í•¨ìˆ˜
        function createDetailModalIfMissing() {
            // ê¸°ì¡´ ì½”ë“œì— ìˆëŠ” id="login-modal" í˜•ì‹ì„ ì°¸ê³ í•˜ì—¬
            // ì‹¤ì œ ìƒì„¸ ëª¨ë‹¬ HTMLì„ <body>ì— ì¶”ê°€í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
            // ì¼ë‹¨ì€ null ë°˜í™˜
            return null;
        }

        // ë¡œê·¸ì¸ ëª¨ë‹¬ ê´€ë ¨
        const loginModal = document.getElementById('login-modal');
        const loginBackdrop = document.getElementById('login-backdrop');
        const loginPanel = document.getElementById('login-panel');
        
        function openLoginModal() {
            if(loginModal) loginModal.classList.remove('hidden');
            if(loginBackdrop) loginBackdrop.classList.remove('opacity-0');
            if(loginPanel) {
                loginPanel.classList.remove('translate-y-4', 'opacity-0');
                loginPanel.classList.add('translate-y-0', 'opacity-100');
            }
        }
        function closeLoginModal() {
            if(loginPanel) {
                loginPanel.classList.remove('translate-y-0', 'opacity-100');
                loginPanel.classList.add('translate-y-4', 'opacity-0');
            }
            if(loginBackdrop) loginBackdrop.classList.add('opacity-0');
            setTimeout(() => {
                if(loginModal) loginModal.classList.add('hidden');
            }, 300);
        }

        // ì—…ë¡œë“œ ëª¨ë‹¬ ì—´ê¸° ë²„íŠ¼ ì—°ê²°
        const showUploadBtn = document.getElementById('show-upload-btn');
        if(showUploadBtn) {
            showUploadBtn.addEventListener('click', () => {
                document.getElementById('upload-modal').classList.remove('hidden');
            });
        }

        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ (ESC ë‹«ê¸°)
        document.addEventListener('keydown', function(event) {
            if (event.key === "Escape") {
                closeLoginModal();
                document.getElementById('upload-modal').classList.add('hidden');
                if(modal) modal.classList.add('hidden');
            }
        });
    </script>
    
</body>
</html>